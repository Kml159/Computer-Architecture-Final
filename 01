ORG 0
    CLA
CIF,    SKI
    BUN CIF
    INP
    STA INPUT
    LDA INPUT
    STA arraged
    CLA
LOP1,
    LDA arraged
    CLE
    CIL
    STA arraged
    ISZ CONST1
    BUN LOP1
    

LOP2,
    LDA arraged
    CLE
    CIL
    STA arraged
    CLA
    LDA BCD

	AND PARSE1
	STA BCD0
	BSA CMP0

	LDA BCD 
	AND PARSE2
	STA BCD1
	BSA CMP1
	
	LDA BCD
	AND PARSE3
	STA BCD2
	BSA CMP2

    	
    CIL
    STA BCD
    ISZ CONST2
    BUN LOP2 

    HLT

// IF GREATER THAN 5, ADD 3
// X >= 5, ADD 3

// BCD0
CMP0,
	
	ADD N5
	SNA  	// IF X<0 SKIP
	BSA UPDATE1
	BUN CMP0 I

// BCD1
CMP1,
	
	ADD N240
	SNA	// IF X<0 SKIP
	BSA UPDATE2
	BUN CMP1 I

// BCD2
CMP2,
	
	ADD N3840
	SNA	// IF X<0 SKIP
	BSA UPDATE3
	BUN CMP2 I
	
UPDATE1,
	ADD NUMBER8
	//STA BCD	
	BUN UPDATE1 I

UPDATE2,
	ADD NUMBER128
	//STA BCD
	BUN UPDATE2 I	
UPDATE3,
	ADD NUMBER2048	
	//STA BCD
	BUN UPDATE3 I
    
CONST1,  DEC -8
CONST2, DEC -8
CONST3, DEC 5
BCD,    DEC 0
INPUT,   DEC 0
arraged,  DEC 0

// NUMBERS TO ADD FOR COMPARE
N5, DEC -5
N240, DEC -80
N3840, DEC -1280

NUMBER8, DEC 8
NUMBER128, DEC 128
NUMBER2048, DEC 2048




PARSE1, DEC 15 		// CHANGE TO DEC
PARSE2, DEC 240
PARSE3, DEC 3840

BCD0,	DEC 0
BCD1,	DEC 0
BCD2,	DEC 0


    END
